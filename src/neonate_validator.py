import csv
import workerthread
import wx

#things we acept for neonate
acceptable_inputs = {'g1_01d', 'g1_01m', 'g1_01y', 'g1_05', 'g1_06d', 'g1_06m', 'g1_06y', 'g1_07a', 'g1_07b', 'g1_07c', 'g1_08', 'g1_09', 'g1_10', 'g2_01', 'g2_02', 
'g2_03ad', 'g2_03am', 'g2_03ay', 'g2_03bd', 'g2_03bm', 'g2_03by', 'g2_03cd', 'g2_03cm', 'g2_03cy', 'g2_03dd', 'g2_03dm', 'g2_03dy', 'g2_03ed', 'g2_03em', 'g2_03ey', 
'g2_03fd', 'g2_03fm', 'g2_03fy', 'g3_01', 'g4_02', 'g4_03a', 'g4_03b', 'g4_04', 'g4_05', 'g4_06', 'g4_07', 'g4_08', 'g5_01d', 'g5_01m', 'g5_01y', 'g5_03d', 'g5_03m', 
'g5_03y', 'g5_05', 'g5_06a', 'g5_06b', 'g5_07', 'g5_08', 'g5_04a', 'g5_04b', 'g5_04c', 'c1_01', 'c1_02', 'c1_03', 'c1_04', 'c1_05b', 'c1_06a', 'c1_07', 'c1_08b', 'c1_09', 
'c1_11', 'c1_12', 'c1_13', 'c1_14', 'c1_15', 'c1_16', 'c1_17', 'c1_18', 'c1_19_1', 'c1_19_2', 'c1_19_3', 'c1_19_4a', 'c1_20b', 'c1_21b', 'c1_22a', 'c1_25', 'c1_26', 
'c2_01_1', 'c2_01_2', 'c2_01_3', 'c2_01_4', 'c2_01_5', 'c2_01_6', 'c2_01_7', 'c2_01_8', 'c2_01_9', 'c2_01_10', 'c2_01_12', 'c2_01_14', 'c2_02b', 'c2_03', 'c2_04', 
'c2_05b', 'c2_06', 'c2_07', 'c2_08a', 'c2_09', 'c2_10b', 'c2_11', 'c2_12', 'c2_13a', 'c2_15a', 'c2_17', 'c2_18', 'c3_01', 'c3_02', 'c3_03_1', 'c3_03_2', 'c3_03_3', 
'c3_04', 'c3_05', 'c3_06', 'c3_07', 'c3_08', 'c3_09', 'c3_10', 'c3_11', 'c3_12', 'c3_13', 'c3_14b', 'c3_15', 'c3_16', 'c3_17', 'c3_18b', 'c3_19b', 'c3_20', 'c3_21b', 
'c3_22b', 'c3_23', 'c3_24', 'c3_25', 'c3_26', 'c3_27b', 'c3_28b', 'c3_29', 'c3_30b', 'c3_31b', 'c3_32', 'c3_33', 'c3_34', 'c3_35', 'c3_36', 'c3_37', 'c3_38', 'c3_39', 
'c3_40', 'c3_41', 'c3_42', 'c3_44', 'c3_45b', 'c3_46', 'c3_47', 'c3_48', 'c3_49', 'c4_01', 'c4_02b', 'c4_03', 'c4_04', 'c4_05', 'c4_06', 'c4_07b', 'c4_08b', 'c4_09', 
'c4_10b', 'c4_11', 'c4_12', 'c4_13b', 'c4_14', 'c4_15', 'c4_16', 'c4_17b', 'c4_18', 'c4_19b', 'c4_20', 'c4_22', 'c4_23', 'c4_24', 'c4_25', 'c4_26', 'c4_27', 'c4_28', 
'c4_29', 'c4_30', 'c4_31_1', 'c4_31_2', 'c4_32', 'c4_33b', 'c4_34', 'c4_35', 'c4_36', 'c4_37b', 'c4_38', 'c4_39', 'c4_40', 'c4_41', 'c4_42', 'c4_43', 'c4_44', 'c4_46', 
'c4_47_1', 'c4_47_2', 'c4_47_3', 'c4_47_4', 'c4_47_5', 'c4_47_6', 'c4_47_7', 'c4_47_8a', 'c4_47_9', 'c4_47_11', 'c4_48', 'c4_49b', 'c5_01', 'c5_02_1', 'c5_02_2', 
'c5_02_3', 'c5_02_4', 'c5_02_5', 'c5_02_6', 'c5_02_7', 'c5_02_8', 'c5_02_9', 'c5_02_10', 'c5_02_11a', 'c5_02_12', 'c5_07_1', 'c5_07_2', 'c5_09', 'c5_12', 'c5_13', 
'c5_14', 'c5_15', 'c5_16', 'c5_17', 'c5_18', 'c5_19', 'g5_02', 'c1_05', 'c1_20', 'c1_21', 'c2_02', 'c2_05', 'c2_10', 'c3_14', 'c3_18', 'c3_19', 'c3_21', 'c3_22', 'c3_27', 
'c3_28', 'c3_30', 'c3_31', 'c1_06b', 'c1_08a', 'c1_10', 'c1_19', 'c2_01_11', 'c2_01_13', 'c3_03_4a', 'c3_03_4b', 'c3_03_5', 'c3_03_6', 'c3_43', 'c3_45a', 'c5_02_11b', 
'c5_02_13', 'c5_02_14', 'c5_03', 'c5_04', 'c5_05', 'c5_06_1d', 'c5_06_1m', 'c5_06_1y', 'c5_06_2d', 'c5_06_2m', 'c5_06_2y', 'c5_08d', 'c5_08m', 'c5_08y', 'c5_10', 'c5_11', 
'c6_01', 'c6_02', 'c6_03', 'c6_04', 'c6_05', 'c6_06', 'c6_07', 'c6_08', 'c6_09', 'c6_10', 'c1_22b', 'c1_23', 'c1_24', 'c1_24d', 'c1_24m', 'c1_24y', 'module', 'c2_08b', 
'c2_13b', 'c2_14', 'c2_15b'}


#conversions from codebook to algorithm
replacements = {'g5_04a': 's2', 'g5_04b': 's3', 'g5_04c': 's4', 'c1_01': 's5', 'c1_02': 's6', 'c1_03': 's7', 'c1_04': 's8', 'c1_05b': 's10', 'c1_06a': 's11', 
'c1_07': 's13', 'c1_08b': 's14', 'c1_09': 's15', 'c1_11': 's16', 'c1_12': 's17', 'c1_13': 's18', 'c1_14': 's19', 'c1_15': 's20', 'c1_16': 's21', 'c1_17': 's22', 
'c1_18': 's23', 'c1_19_1': 's24', 'c1_19_2': 's25', 'c1_19_3': 's26', 'c1_19_4a': 's27', 'c1_20b': 's28', 'c1_21b': 's29', 'c1_22a': 's30', 'c1_25': 's31', 
'c1_26': 's32', 'c2_01_1': 's33', 'c2_01_2': 's34', 'c2_01_3': 's35', 'c2_01_4': 's36', 'c2_01_5': 's37', 'c2_01_6': 's38', 'c2_01_7': 's39', 'c2_01_8': 's40', 
'c2_01_9': 's41', 'c2_01_10': 's42', 'c2_01_12': 's43', 'c2_02b': 's45', 'c2_03': 's46', 'c2_04': 's47', 'c2_05b': 's48', 'c2_06': 's49', 'c2_07': 's50', 'c2_08a': 's51', 
'c2_09': 's52', 'c2_10b': 's53', 'c2_11': 's54', 'c2_12': 's55', 'c2_13a': 's56', 'c2_15a': 's57}', 'c2_17': 's58', 'c2_18': 's59', 'c3_01': 's60', 'c3_02': 's61', 
'c3_03_1': 's62', 'c3_03_2': 's63', 'c3_03_3': 's64', 'c3_04': 's65', 'c3_05': 's66', 'c3_06': 's67', 'c3_07': 's68', 'c3_08': 's69', 'c3_09': 's70', 'c3_10': 's71', 
'c3_11': 's72', 'c3_12': 's73', 'c3_13': 's74', 'c3_14b': 's75', 'c3_15': 's76', 'c3_16': 's77', 'c3_17': 's78', 'c3_18b': 's79', 'c3_19b': 's80', 'c3_20': 's81', 
'c3_21b': 's82', 'c3_22b': 's83', 'c3_23': 's84', 'c3_24': 's85', 'c3_25': 's86', 'c3_26': 's87', 'c3_27b': 's88', 'c3_28b': 's89', 'c3_29': 's90', 'c3_30b': 's91', 
'c3_31b': 's92', 'c3_32': 's93', 'c3_33': 's94', 'c3_34': 's95', 'c3_35': 's96', 'c3_36': 's97', 'c3_37': 's98', 'c3_38': 's99', 'c3_39': 's100', 'c3_40': 's101', 
'c3_41': 's102', 'c3_42': 's103', 'c3_44': 's104', 'c3_45b': 's105', 'c3_46': 's106', 'c3_47': 's107', 'c3_48': 's108', 'c3_49': 's109', 'c4_01': 's110', 'c4_02b': 's111', 
'c4_03': 's112', 'c4_04': 's113', 'c4_05': 's114', 'c4_06': 's115', 'c4_07b': 's116', 'c4_08b': 's117', 'c4_09': 's118', 'c4_10b': 's119', 'c4_11': 's120', 'c4_12': 's121', 
'c4_13b': 's122', 'c4_14': 's123', 'c4_15': 's124', 'c4_16': 's125', 'c4_17b': 's126', 'c4_18': 's127', 'c4_19b': 's128', 'c4_20': 's129', 'c4_22': 's130', 'c4_23': 's131', 
'c4_24': 's132', 'c4_25': 's133', 'c4_26': 's134', 'c4_27': 's135', 'c4_28': 's136', 'c4_29': 's137', 'c4_30': 's138', 'c4_31_1': 's139', 'c4_31_2': 's140', 'c4_32': 's141', 
'c4_33b': 's142', 'c4_34': 's143', 'c4_35': 's144', 'c4_36': 's145', 'c4_37b': 's146', 'c4_38': 's147', 'c4_39': 's148', 'c4_40': 's149', 'c4_41': 's150', 'c4_42': 's151', 
'c4_43': 's152', 'c4_44': 's153', 'c4_46': 's154', 'c4_47_1': 's155', 'c4_47_2': 's156', 'c4_47_3': 's157', 'c4_47_4': 's158', 'c4_47_5': 's159', 'c4_47_6': 's160', 
'c4_47_7': 's161', 'c4_47_8a': 's162', 'c4_47_9': 's163', 'c4_47_11': 's164', 'c4_48': 's165', 'c4_49b': 's166', 'c5_01': 's167', 'c5_02_1': 's168', 'c5_02_2': 's169', 
'c5_02_3': 's170', 'c5_02_4': 's171', 'c5_02_5': 's172', 'c5_02_6': 's173', 'c5_02_7': 's174', 'c5_02_8': 's175', 'c5_02_9': 's176', 'c5_02_10': 's177', 'c5_02_11a': 's178', 
'c5_02_12': 's179', 'c5_07_1': 's180', 'c5_07_2': 's181', 'c5_09': 's182', 'c5_12': 's183', 'c5_13': 's184', 'c5_14': 's185', 'c5_15': 's186', 'c5_16': 's187', 'c5_17': 's188', 
'c5_18': 's189', 'c5_19': 's190', 'g5_02': 'sex', 'c1_05': 's9', 'c1_20': 's28', 'c1_21': 's29', 'c2_02': 's45', 'c2_05': 's48', 'c2_10': 's53', 'c3_14': 's75', 'c3_18': 's79', 
'c3_19': 's80', 'c3_21': 's82', 'c3_22': 's83', 'c3_27': 's88', 'c3_28': 's89', 'c3_30': 's91', 'c3_31': 's92'}
 



def validate(notify_window, inputfile):
    spamReader = csv.reader(open(inputfile, 'rbU'))
    
    firstrow =  spamReader.next()
    temp = len(firstrow)
    
    print "just curious " + str(temp)
    
    for column in firstrow:
        success = True
        if column not in acceptable_inputs:
            updatestr = "error: '" + column + "' is not a recognized column\n"
            wx.PostEvent(notify_window, workerthread.ResultEvent(updatestr))
            success = False
        else:
            test = replacements[column]
            print "woohoo " + test
            #yay, do nothing
    
    return success
    
    